# Slide-tags network analysis

Python code for processing and visualizing Slide-tags data as presented in the paper "Hidden network preserved in Slide-tags data allows reference-free spatial reconstruction" 
https://www.biorxiv.org/content/10.1101/2024.06.16.598614v1.

barcode_processing.py is used to convert the raw output file of the relevant part of Russel et al.'s pipeline to the format for comparing with ground truth positions

Filtering_and_edge_plotting.py is used to filter the resulting edge list and do a simple plotting of the known cell positions as well as overlapping the unipartite network edges

density_calculations.py is used to calculate the etsimated cell and normalized UMI densitites as well as performing relevant statistical tests on those densities

The pair of main.py and functions.py is used to analyse the reconstructed subgraphs, as well as generate refiltered edgelists from the raw, highly filtered edgelists.

Quality_metrics.py contains a class with functions for assessing reconstruction qualities and is used in functions.py and stems from earlier STRND reconstruction work available through the link below as well.

Subgraphs are generated from the Reconstruction pipelines with analyzes any input network to separate subgraphs as a part of its initial steps available, for details please the github for [Spatial coherence](https://github.com/DavidFernandezBonet/Network_Spatial_Coherence?tab=readme-ov-file). For additional details regarding [spatial coherence](https://www.biorxiv.org/content/10.1101/2024.05.12.593725v1.abstract) and [STRND reconstruction](https://pubs.rsc.org/en/content/articlehtml/2023/nr/d2nr05435c), please refer to the respective papers.

This page and containing code will come to be updated for clarity and usability, especially the main.py and function.py pair.

The folder structure should be prepared like this:
```
Main_Folder/
├── {Sample}/
│   ├── {Run} (generated by filtering code)/
│   │   └──filtered_edgelists.txt
│   ├── barcodes_ncbi.csv (barcodes of the known cell positions, downloaded from the Russell et al. SCP entry)
│   └── {Sample}_spatial.csv (known cell positions)
├── 3M-february-2018.txt (Cellranger barcode pairs available from 10X genomics)

├── raw_edge_lists.py
├── barcode_processing.py
├── Filtering_and_edge_plotting.py
├── density_calculations.py
├── main.py
├── functions.py
└── Quality_metrics.py
```
The reconstruction code will also generate subfolders within which edgelists should be deposited, and these folders are then used to find and process the edgelsits files post-reconstruction in such a way that they should be generated withing the {run} folder by using that as the running directory for the reconstruction.
